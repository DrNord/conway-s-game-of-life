/*!
Copyright (C) 2021 Dr. Nord
*/
let l=new function(){var e=this;e.rows=2,e.cols=2,e.f_rows=4,e.f_cols=4,e.cell_size=1,e.canvas_width=2,e.canvas_height=2,e.scroll_x=0,e.scroll_y=0,e.vertices=new Array(e.rows*e.cols*2).fill(0),e.alive_quantity_visible=0,e.setAttributes=s,e.computeDrawCoordinates=i};function s(e){var s=e,e=this;e.rows=s.rows,e.cols=s.cols,e.f_rows=e.rows+2,e.f_cols=e.cols+2,e.cell_size=s.cell_size,e.canvas_width=s.canvas_width,e.canvas_height=s.canvas_height,e.scroll_x=s.scroll_x,e.scroll_y=s.scroll_y,e.vertices=new Float32Array(e.rows*e.cols*2).fill(0)}function i(l){var i,c,o=this;let t=0;var a=e(-1,1,o.canvas_width,o.cell_size),r=e(-1,1,o.canvas_height,o.cell_size);for(let s=1;s<o.f_rows-1;s++)for(let e=1;e<o.f_cols-1;e++)1===l[s*o.f_cols+e]&&-1-a<=(i=_(-1,1,o.canvas_width,o.cell_size,e,o.scroll_x))&&i<=1+a&&-1-r<=(c=-1*_(-1,1,o.canvas_height,o.cell_size,s,o.scroll_y))&&c<=1+r&&(o.vertices[t]=i,o.vertices[t+1]=c,t+=2);o.alive_quantity_visible=t/2}function _(e,s,l,i,c,o){return e+(i*(.5+c-1)+o)*(s-e)/l}function e(e,s,l,i){return l*(s-e)/i}self.onmessage=function(e){var s=e.data;if(void 0!==s.cmd)switch(s.cmd){case"get_webgl_coordinates":l.computeDrawCoordinates(s.field),postMessage({vertices:l.vertices.slice(0,2*l.alive_quantity_visible),quantity:l.alive_quantity_visible,cell_size:l.cell_size});break;case"set_dimensions":l.setAttributes(s);break;default:console.log("Worker-visual: command '"+s.cmd+"' is not supported.")}else console.log("Worker-visual: choose allowed command please.")};