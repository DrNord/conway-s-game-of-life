/*!
Conway's Game of Life
Copyright (C) 2021 Dr. Nord
*/
import*as d from"./pageViewControl.js";import*as a from"./gameOfLife.js";import*as g from"../resources/color-parse-to-rgb/rgbcolor.js";import*as r from"./common.js";let s=new Uint8Array(1);function e(){window.onresize=t,window.onload=()=>{window.dispatchEvent(new Event("resize")),s.cell_color_rgb=new g.RGBColor(window.getComputedStyle(document.body).getPropertyValue("--colorParticle")),a.gameOfLife(),a.game.cell_color_rgba=[s.cell_color_rgb.r/255,s.cell_color_rgb.g/255,s.cell_color_rgb.b/255,1],function(){window.ontouchmove=()=>{window.dispatchEvent(new Event("resize"))},screen.orientation.onchange=()=>{window.dispatchEvent(new Event("resize"))},window.onclick=d.closeUnnecessary;let e=document.getElementById("cogs");e.switch=d.dropmenuSwitch,e.onclick=e.switch,document.getElementById("switchLight").onclick=function(){d.lightSwitch(this),s.cell_color_rgb=new g.RGBColor(window.getComputedStyle(document.body).getPropertyValue("--colorParticle")),a.game.cell_color_rgba=[s.cell_color_rgb.r/255,s.cell_color_rgb.g/255,s.cell_color_rgb.b/255,1],a.game.visualize()},document.getElementById("fullwindow").onclick=d.fullwindowSwitch,document.getElementById("fullscreen").onclick=d.fullscreenSwitch,document.onfullscreenchange=d.fullscreenSwitchIcon,document.onscroll=d.settingsButtonTransparency;let t=document.getElementById("mainHeader");r.resizeObserve(t,()=>{let e=t;e.content_height=d.getContentHeight(e),d.settingsButtonTransparency()},10);let n=document.getElementById("mainFooter");r.resizeObserve(n,()=>{let e=n;e.content_height=d.getContentHeight(e)},10);let o=document.getElementById("game-field");o.onpointerdown=e=>{s.down=!0,s.t_down=performance.now(),e.preventDefault()},o.onpointerup=e=>{s.down=!1,performance.now()-s.t_down<250&&(document.getElementById("dropMenu").classList.contains("visible")||a.game.restart()),e.preventDefault()},o.onpointermove=()=>{s.down&&a.game.nextEpoch()};let l=document.getElementById("t_epoch");l.oninput=a.game.changeSimTime,l.onchange=a.game.changeSimTime,l.value=(100-a.game.percentageVal(a.game.dt_epoch_ms,a.game.dt_epoch_min,a.game.dt_epoch_max)).toString(),document.getElementById("fit_field").onclick=a.game.fitFieldRestart,document.getElementById("playPause").onclick=a.game.playPause,document.getElementById("restart").onclick=a.game.restart;let i=document.getElementById("zoom_slider");i.oninput=a.game.zoomSlide,i.onchange=a.game.zoomSlide,i.value=a.game.percentageVal(a.game.cell_size,a.game.cell_size_min,a.game.cell_size_max).toString(),document.getElementById("zoomIn").onclick=a.game.zoomIn,document.getElementById("zoomOut").onclick=a.game.zoomOut;let c=document.getElementById("game_settings");c.switch=d.gameSettingsModalSwitch.bind(null,a.game),c.onclick=c.switch,document.getElementById("settings_field_width").oninput=d.validateNatural,document.getElementById("settings_field_width").value=a.game.cols,document.getElementById("settings_field_height").oninput=d.validateNatural,document.getElementById("settings_field_height").value=a.game.rows,document.getElementById("settings_dt_epoch_min").oninput=d.validateNatural,document.getElementById("settings_dt_epoch_min").value=a.game.dt_epoch_min,document.getElementById("settings_dt_epoch_max").oninput=d.validateNatural,document.getElementById("settings_dt_epoch_max").value=a.game.dt_epoch_max,document.getElementById("settings_alive_probability").oninput=d.validateFloat,document.getElementById("settings_alive_probability").value=a.game.alive_probability,document.getElementById("settings_apply").onclick=a.game.settingsApply,document.getElementById("settings_cancel").onclick=()=>{c.switch()},document.getElementById("settings_close").onclick=()=>{c.switch()},document.getElementById("settings_apply_and_restart").onclick=a.game.settingsApplyRestart,document.getElementById("game_settings_modal").onkeydown=e=>{switch(e.key){case"Enter":a.game.settingsApplyRestart();break;case"Escape":c.switch()}};let m=document.getElementById("game_info");m.switch=d.gameInfoModalSwitch,m.onclick=m.switch,document.getElementById("game_info_modal").onclick=()=>{m.switch()},document.getElementById("game_info_modal").onkeydown=e=>{switch(e.key){case"Enter":case"Escape":m.switch()}}}()}}function t(){var e=parseInt(window.getComputedStyle(document.body).getPropertyValue("--main-width-max")),t=parseInt(window.getComputedStyle(document.body).getPropertyValue("--main-width-min")),n=document.documentElement.clientWidth;e<n?document.body.style.setProperty("--main-foreground-width",e+"px"):n<t?document.body.style.setProperty("--main-foreground-width",t+"px"):document.body.style.setProperty("--main-foreground-width","100%");n=document.documentElement.clientHeight;document.body.style.setProperty("--main-foreground-visible-height",n+"px");t=document.getElementById("mainHeader").getElementsByTagName("div")[0].offsetHeight,n=window.getComputedStyle(document.body).getPropertyValue("--padding-normal");let o=document.getElementById("settingsSection").style;o.top=t/2+"px",o.right=n}export{e as app};